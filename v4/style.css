/* --- 基本設定と変数 --- */
:root {
    --primary-color: #3498db; --secondary-color: #f1f1f1; --font-color: #333;
    --background-color: #fff; --border-color: #ddd; --header-bg: rgba(255, 255, 255, 0.85);
    --header-color: #000; --highlight-bg: #fff38a; --highlight-color: #000;
}
body[data-theme='dark'] {
    --primary-color: #5dade2; --secondary-color: #2c3e50; --font-color: #ecf0f1;
    --background-color: #1c2833; --border-color: #34495e; --header-bg: rgba(28, 40, 51, 0.85);
    --header-color: #ecf0f1; --highlight-bg: #f1c40f; --highlight-color: #333;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; background-color: var(--background-color); color: var(--font-color); transition: background-color 0.3s, color 0.3s; -webkit-tap-highlight-color: transparent; }
*::-webkit-scrollbar { display: none; }

/* --- ヘッダー --- */
header { position: fixed; top: 0; left: 0; right: 0; display: flex; width: 100%; height: 48px; background-color: var(--header-bg); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); color: var(--header-color); align-items: center; justify-content: space-between; padding: 0 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); z-index: 1000; }
.header-title { display: flex; font-size: 1.1rem; font-weight: bold; }
.header-actions { display: flex; align-items: center; }
.action-icon { font-size: 24px; cursor: pointer; padding: 10px; }
#syou { margin-left: 0.5em; }

/* --- メインコンテンツ --- */
main { padding: 60px 15px; min-height: 100vh; padding-bottom: 80px; }
.loader { text-align: center; color: #888; padding: 50px 20px; }

/* ★★★★★ここからレイアウト修正★★★★★ */

/* --- 聖句表示コンテナ --- */
.verse-container {
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--border-color);
}
.verse-container:last-child { border-bottom: none; }

/* 節番号(上部に配置) */
.verse-ref {
    color: var(--primary-color);
    font-weight: bold;
    margin-bottom: 8px;
}
/* 左右の言語を囲むラッパー */
.verse-content {
    display: flex;
    gap: 20px;
}
.jp, .ch {
    flex: 1;
    min-width: 0; /* ★Flexboxの縮小を許可し、はみ出しを防止 */
    overflow-wrap: break-word; /* ★長い単語やURLを折り返す設定(横スクロール防止) */
}

/* --- 検索結果 --- */
.search-result-item { padding: 12px; border: 1px solid var(--border-color); border-radius: 5px; margin-bottom: 10px; cursor: pointer; transition: background-color 0.2s; }
.search-result-item:hover { background-color: var(--secondary-color); }
/* 検索結果の節参照は色を少し変える */
.search-result-item .verse-ref {
    color: var(--font-color);
    font-size: 0.9em;
}

/* ★★★★★ここまで修正★★★★★ */

/* --- ボトムナビゲーションバー --- */
.bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: 60px; background-color: var(--header-bg); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); box-shadow: 0 -2px 5px rgba(0,0,0,0.1); display: flex; justify-content: space-around; align-items: center; z-index: 1000; }
.bottom-nav button { background: none; border: none; color: var(--primary-color); font-size: 1.5rem; font-weight: bold; cursor: pointer; padding: 15px 20px; border-radius: 8px; transition: background-color 0.2s; }
.bottom-nav button:hover { background-color: var(--secondary-color); }
.bottom-nav button:disabled { color: var(--border-color); cursor: not-allowed; }

/* --- サイドバー & その他 --- */
.sidebar { height: 100%; width: 300px; max-width: 85vw; position: fixed; z-index: 2000; top: 0; left: 0; background-color: var(--background-color); overflow-y: auto; transition: transform 0.3s ease-in-out; transform: translateX(-100%); padding: 20px; box-shadow: 3px 0 6px rgba(0,0,0,0.1); }
.sidebar.open { transform: translateX(0); }
.sidebar .close-btn { position: absolute; top: 5px; right: 15px; font-size: 36px; cursor: pointer; color: var(--font-color); }
.sidebar h2 { margin-top: 30px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; font-size: 1.2rem; }
.control-group { margin-bottom: 20px; }
label { display: block; margin-bottom: 8px; font-weight: 500;}
select, input[type="search"], .action-btn { width: 100%; padding: 10px; font-size: 16px; border: 1px solid var(--border-color); background-color: var(--secondary-color); color: var(--font-color); border-radius: 5px; }
.action-btn { background-color: var(--primary-color); color: white; border: none; cursor: pointer; margin-top: 10px; }
.overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1500; display: none; opacity: 0; transition: opacity 0.3s ease-in-out; }
.overlay.open { display: block; opacity: 1; }
.settings { margin-top: 20px; }
.switch-container { display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px; }
.switch { position: relative; display: inline-block; width: 44px; height: 24px; }
.switch input { display:none; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px; }
.slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%; }
input:checked + .slider { background-color: var(--primary-color); }
input:checked + .slider:before { transform: translateX(20px); }
.highlight { background-color: var(--highlight-bg); color: var(--highlight-color); border-radius: 3px; }
.jp, .ch { line-height: 1.8; }
ruby { ruby-position: over; }
rt { font-size: 0.6em; }
rt.furigana { color:#f2d26b; }
rt.pinyin { color:#f199a2; font-style: italic; }